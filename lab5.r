## –ó–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (8) –¥–ª—è ‚àÜ = 0.0001 ( —Ç.–µ. —Å—Ä–µ–¥–Ω–µ-–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–µ )
Brownian = function(n,B0,d){
  Brownian = numeric(n)
  k = numeric(n)
  Brownian[1] = B0
  k[1] = d
  for(i in 2:n){
    e = rnorm(1,0,sqrt(d))
    Brownian[i] = Brownian[i-1]+e
    k[i] = i*d
  }
  return(data.frame(Brownian,k))
}
n = 1000
d = 0.0001
B0 = 0
B=Brownian(n,B0,d)
plot(B$k,B$Brownian,type="l",col="blue")

## –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞, –∑–∞–º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ, 
## –∏ –≤—ã–≤–µ—Å—Ç–∏ –≤—Å–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞ –Ω–∞ –æ–¥–∏–Ω –≥—Ä–∞—Ñ–∏–∫. –¢.–µ.
## –ø–æ—Å—Ç—Ä–æ–∏—Ç—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (8) –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ.

for(i in 1:199){
  B=Brownian(n,B0,d)
  lines(B$k,B$Brownian,type = "l",col="blue")
}
## –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∞–Ω—Å–∞–º–±–ª—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ –ø–æ –ø—Ä–∞–≤–∏–ª—É —Ç—Ä–µ—Ö —Å–∏–≥–º.
lines(B$k,3*sqrt(B$k),col = "red",type = "l", lwd = 2)
lines(B$k,-3*sqrt(B$k),col = "red",type = "l",lwd = 2)

## –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å (9) –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –≤—Ö–æ–¥–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
##ùëÜ0 = 1, ùëé = 0.5, ùúé = 0.9,‚àö‚àÜ = 0.01, ùëò = 0, 1, . . . , 103.
S = function(n,d,a,sigma,S0,B0){
  S = numeric(n)
  B=Brownian(n,B0,d)
  k = B$k
  S[1] = S0
  for(i in 2:n){
    S[i] = S0*exp((a-(sigma**2)/2)*i*d+sigma*B$Brownian[i])
  }
  return (data.frame(S,k))
}
n = 1000
S0 = 1
B0 = 0
a = 0.5
d = 0.0001
sigma = 0.9
s = S(n,d,a,sigma,S0,B0)
plot(s$k,s$S,type = "l",col="blue")

## –ü–æ—Å—Ç—Ä–æ–∏—Ç—å 200 —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –ø—Ä–æ—Ü–µ—Å—Å–∞ (10) –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ.
for(i in 1:199){
  s = S(n,d,a,sigma,S0,B0)
  lines(s$k,s$S,type = "l",col="blue")
}

